# Filmorate Database Schema

## –û–ø–∏—Å–∞–Ω–∏–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—ã –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö

### –û—Å–Ω–æ–≤–Ω—ã–µ —Å—É—â–Ω–æ—Å—Ç–∏

#### 1. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ (`users`)

| –ü–æ–ª–µ       | –¢–∏–ø         | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è                          | –û–ø–∏—Å–∞–Ω–∏–µ                |
|------------|-------------|--------------------------------------|-------------------------|
| user_id    | INT         | GENERATED BY DEFAULT AS IDENTITY PK  | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä|
| email      | VARCHAR(50) | NOT NULL, UNIQUE                     | –≠–ª–µ–∫—Ç—Ä–æ–Ω–Ω–∞—è –ø–æ—á—Ç–∞       |
| login      | VARCHAR(50) | NOT NULL                             | –õ–æ–≥–∏–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è      |
| name       | VARCHAR(50) |                                      | –ò–º—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è        |
| birthday   | DATE        |                                      | –î–∞—Ç–∞ —Ä–æ–∂–¥–µ–Ω–∏—è           |

#### 2. –§–∏–ª—å–º—ã (`films`)

| –ü–æ–ª–µ          | –¢–∏–ø          | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è                          | –û–ø–∏—Å–∞–Ω–∏–µ               |
|---------------|--------------|--------------------------------------|------------------------|
| film_id       | INT          | GENERATED BY DEFAULT AS IDENTITY PK  | –£–Ω–∏–∫–∞–ª—å–Ω—ã–π –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä|
| name          | VARCHAR(100) | NOT NULL                             | –ù–∞–∑–≤–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞        |
| description   | VARCHAR(200) |                                      | –û–ø–∏—Å–∞–Ω–∏–µ —Ñ–∏–ª—å–º–∞        |
| release_date  | DATE         | NOT NULL                             | –î–∞—Ç–∞ –≤—ã—Ö–æ–¥–∞            |
| duration      | INT          | NOT NULL, CHECK (duration > 0)       | –ü—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å(–º–∏–Ω) |
| mpa_rating_id | INT          | REFERENCES mpa_rating(mpa_id)        | –í–æ–∑—Ä–∞—Å—Ç–Ω–æ–π —Ä–µ–π—Ç–∏–Ω–≥     |

### –°–ø—Ä–∞–≤–æ—á–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

#### 3. –ñ–∞–Ω—Ä—ã (`genre`)

| –ü–æ–ª–µ       | –¢–∏–ø         | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è               | –û–ø–∏—Å–∞–Ω–∏–µ         |
|------------|-------------|---------------------------|------------------|
| genre_id   | INT         | PRIMARY KEY               | ID –∂–∞–Ω—Ä–∞         |
| name       | VARCHAR(50) | NOT NULL, UNIQUE          | –ù–∞–∑–≤–∞–Ω–∏–µ –∂–∞–Ω—Ä–∞   |

#### 4. –í–æ–∑—Ä–∞—Å—Ç–Ω—ã–µ —Ä–µ–π—Ç–∏–Ω–≥–∏ (`mpa_rating`)

| –ü–æ–ª–µ         | –¢–∏–ø         | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è               | –û–ø–∏—Å–∞–Ω–∏–µ               |
|--------------|-------------|---------------------------|------------------------|
| mpa_id       | INT         | PRIMARY KEY               | ID —Ä–µ–π—Ç–∏–Ω–≥–∞            |
| mpa_name     | VARCHAR(10) | NOT NULL, UNIQUE          | –ö–æ–¥ —Ä–µ–π—Ç–∏–Ω–≥–∞ (G, PG-13)|
| description  | VARCHAR(200)|                           | –û–ø–∏—Å–∞–Ω–∏–µ —Ä–µ–π—Ç–∏–Ω–≥–∞      |

#### 5. –†–µ–∂–∏—Å—Å–µ—Ä—ã (`directors`)

| –ü–æ–ª–µ        | –¢–∏–ø          | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è                          | –û–ø–∏—Å–∞–Ω–∏–µ          |
|-------------|--------------|--------------------------------------|-------------------|
| id | INT          | GENERATED BY DEFAULT AS IDENTITY PK  | ID —Ä–µ–∂–∏—Å—Å–µ—Ä–∞      |
| name        | VARCHAR(100) | NOT NULL                             | –ò–º—è —Ä–µ–∂–∏—Å—Å–µ—Ä–∞     |

### –¢–∞–±–ª–∏—Ü—ã —Å–≤—è–∑–µ–π

#### 6. –î—Ä—É–∂–±–∞ (`friendship`)

| –ü–æ–ª–µ         | –¢–∏–ø         | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è                              | –û–ø–∏—Å–∞–Ω–∏–µ                |
|--------------|-------------|------------------------------------------|-------------------------|
| user_id      | INT         | PK, FK (users.user_id) ON DELETE CASCADE | ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è         |
| friend_id    | INT         | PK, FK (users.user_id) ON DELETE CASCADE | ID –¥—Ä—É–≥–∞                |
| status       | VARCHAR(20) | DEFAULT 'PENDING', CHECK IN ('PENDING','CONFIRMED') | –°—Ç–∞—Ç—É—Å –¥—Ä—É–∂–±—ã |
| created_date | TIMESTAMP   | DEFAULT CURRENT_TIMESTAMP                | –î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Å–≤—è–∑–∏     |

#### 7. –°–≤—è–∑—å —Ñ–∏–ª—å–º–æ–≤ –∏ –∂–∞–Ω—Ä–æ–≤ (`film_genre`)

| –ü–æ–ª–µ     | –¢–∏–ø  | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è                              | –û–ø–∏—Å–∞–Ω–∏–µ         |
|----------|------|------------------------------------------|------------------|
| film_id  | INT  | PK, FK (films.film_id) ON DELETE CASCADE | ID —Ñ–∏–ª—å–º–∞        |
| genre_id | INT  | PK, FK (genre.genre_id) ON DELETE CASCADE| ID –∂–∞–Ω—Ä–∞         |

#### 8. –õ–∞–π–∫–∏ —Ñ–∏–ª—å–º–æ–≤ (`film_likes`)

| –ü–æ–ª–µ     | –¢–∏–ø  | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è                              | –û–ø–∏—Å–∞–Ω–∏–µ         |
|----------|------|------------------------------------------|------------------|
| film_id  | INT  | PK, FK (films.film_id) ON DELETE CASCADE | ID —Ñ–∏–ª—å–º–∞        |
| user_id  | INT  | PK, FK (users.user_id) ON DELETE CASCADE | ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è  |

#### 9. –°–≤—è–∑—å —Ñ–∏–ª—å–º–æ–≤ –∏ —Ä–µ–∂–∏—Å—Å–µ—Ä–æ–≤ (`film_directors`)

| –ü–æ–ª–µ        | –¢–∏–ø  | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è                              | –û–ø–∏—Å–∞–Ω–∏–µ         |
|-------------|------|------------------------------------------|------------------|
| film_id     | INT  | PK, FK (films.film_id) ON DELETE CASCADE | ID —Ñ–∏–ª—å–º–∞        |
| id | INT  | PK, FK (directors.id) ON DELETE CASCADE | ID —Ä–µ–∂–∏—Å—Å–µ—Ä–∞ |

### –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–µ —Ç–∞–±–ª–∏—Ü—ã

#### 10. –û—Ç–∑—ã–≤—ã (`reviews`)

| –ü–æ–ª–µ        | –¢–∏–ø     | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è                              | –û–ø–∏—Å–∞–Ω–∏–µ                     |
|-------------|---------|------------------------------------------|------------------------------|
| review_id   | INT     | GENERATED BY DEFAULT AS IDENTITY PK      | ID –æ—Ç–∑—ã–≤–∞                    |
| content     | TEXT    | NOT NULL                                 | –¢–µ–∫—Å—Ç –æ—Ç–∑—ã–≤–∞                 |
| is_positive | BOOLEAN | NOT NULL                                 | –¢–∏–ø –æ—Ç–∑—ã–≤–∞(true=–ø–æ–ª–æ–∂–∏—Ç–µ–ª—å–Ω—ã–π) |
| user_id     | INT     | FK (users.user_id) ON DELETE CASCADE     | ID –∞–≤—Ç–æ—Ä–∞                    |
| film_id     | INT     | FK (films.film_id) ON DELETE CASCADE     | ID —Ñ–∏–ª—å–º–∞                    |
| useful      | INT     | DEFAULT 0                                | –†–µ–π—Ç–∏–Ω–≥ –ø–æ–ª–µ–∑–Ω–æ—Å—Ç–∏           |

#### 11. –û—Ü–µ–Ω–∫–∏ –æ—Ç–∑—ã–≤–æ–≤ (`review_likes`)

| –ü–æ–ª–µ      | –¢–∏–ø     | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è                              | –û–ø–∏—Å–∞–Ω–∏–µ                     |
|-----------|---------|------------------------------------------|------------------------------|
| review_id | INT     | PK, FK (reviews.review_id) ON DELETE CASCADE | ID –æ—Ç–∑—ã–≤–∞                |
| user_id   | INT     | PK, FK (users.user_id) ON DELETE CASCADE | ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è           |
| is_like   | BOOLEAN | NOT NULL                                 | –û—Ü–µ–Ω–∫–∞ (true=–ø–æ–ª–µ–∑–Ω–æ)      |

#### 12. –õ–µ–Ω—Ç–∞ —Å–æ–±—ã—Ç–∏–π (`feed`)

| –ü–æ–ª–µ       | –¢–∏–ø         | –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è                              | –û–ø–∏—Å–∞–Ω–∏–µ                     |
|------------|-------------|------------------------------------------|------------------------------|
| event_id   | INT         | GENERATED BY DEFAULT AS IDENTITY PK      | ID —Å–æ–±—ã—Ç–∏—è                   |
| user_id    | INT         | FK (users.user_id) ON DELETE CASCADE     | ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è              |
| event_type | VARCHAR(10) | NOT NULL, CHECK IN ('LIKE','REVIEW','FRIEND') | –¢–∏–ø —Å–æ–±—ã—Ç–∏—è         |
| operation  | VARCHAR(10) | NOT NULL, CHECK IN ('ADD','REMOVE','UPDATE') | –û–ø–µ—Ä–∞—Ü–∏—è           |
| entity_id  | INT         | NOT NULL                                 | ID —Å–≤—è–∑–∞–Ω–Ω–æ–π —Å—É—â–Ω–æ—Å—Ç–∏        |
| timestamp  | TIMESTAMP   | DEFAULT CURRENT_TIMESTAMP                | –í—Ä–µ–º—è —Å–æ–±—ã—Ç–∏—è                |

## –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### üéØ –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏
**–ê–≤—Ç–æ—Ä**: [Romanenko3490](https://github.com/Romanenko3490) | **SP**: 3  
–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–π –Ω–∞ –æ—Å–Ω–æ–≤–µ Slope One. –°–∏—Å—Ç–µ–º–∞ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ—Ç –æ—Ü–µ–Ω–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç —Ñ–∏–ª—å–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –º–æ–≥—É—Ç –ø–æ–Ω—Ä–∞–≤–∏—Ç—å—Å—è.

### üìù –û—Ç–∑—ã–≤—ã
**–ê–≤—Ç–æ—Ä**: [Romanenko3490](https://github.com/Romanenko3490) | **SP**: 4  
–ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –æ—Ç–∑—ã–≤–æ–≤ —Å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å—é –æ—Ü–µ–Ω–∫–∏ –ø–æ–ª–µ–∑–Ω–æ—Å—Ç–∏. –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –æ—Å—Ç–∞–≤–ª—è—Ç—å –æ—Ç–∑—ã–≤—ã –∏ –æ—Ü–µ–Ω–∏–≤–∞—Ç—å —á—É–∂–∏–µ.

### üîç –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ –ø–æ –∂–∞–Ω—Ä—É/–≥–æ–¥—É
**–ê–≤—Ç–æ—Ä**: [artpchelintsev](https://github.com/artpchelintsev) | **SP**: 2  
–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ–ø—É–ª—è—Ä–Ω—ã—Ö —Ñ–∏–ª—å–º–æ–≤ –ø–æ –∂–∞–Ω—Ä—É –∏ –≥–æ–¥—É –≤—ã–ø—É—Å–∫–∞. –ì–∏–±–∫–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø–æ–¥–±–æ—Ä–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.

### üîé –ü–æ–∏—Å–∫
**–ê–≤—Ç–æ—Ä**: [artpchelintsev](https://github.com/artpchelintsev) | **SP**: 3  
–ü–æ–∏—Å–∫ —Ñ–∏–ª—å–º–æ–≤ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏ —Ä–µ–∂–∏—Å—Å–µ—Ä—É. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —á–∞—Å—Ç–∏—á–Ω–æ–≥–æ —Å–æ–≤–ø–∞–¥–µ–Ω–∏—è –∏ —Ä–µ–≥–∏—Å—Ç—Ä–æ–Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–π –ø–æ–∏—Å–∫.

### üé¨ –†–µ–∂–∏—Å—Å–µ—Ä—ã
**–ê–≤—Ç–æ—Ä**: [ajdauksha](https://github.com/ajdauksha) | **SP**: 4  
–ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö —Ä–µ–∂–∏—Å—Å–µ—Ä–æ–≤ —É –æ–¥–Ω–æ–≥–æ —Ñ–∏–ª—å–º–∞. –ü–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ä–µ–∂–∏—Å—Å–µ—Ä–æ–≤ –≤ —Å–∏—Å—Ç–µ–º—É.

### üóëÔ∏è –£–¥–∞–ª–µ–Ω–∏–µ
**–ê–≤—Ç–æ—Ä**: [ajdauksha](https://github.com/ajdauksha) | **SP**: 2  
–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Ñ–∏–ª—å–º–æ–≤ —Å –∫–∞—Å–∫–∞–¥–Ω—ã–º —É–¥–∞–ª–µ–Ω–∏–µ–º —Å–≤—è–∑–∞–Ω–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö.

### üé• –û–±—â–∏–µ —Ñ–∏–ª—å–º—ã
**–ê–≤—Ç–æ—Ä**: [StepanovAlAl](https://github.com/StepanovAlAl) | **SP**: 1  
–ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–±—â–∏–µ —Ñ–∏–ª—å–º—ã, –∫–æ—Ç–æ—Ä—ã–µ –ø–æ–Ω—Ä–∞–≤–∏–ª–∏—Å—å –æ–±–æ–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º. –£–¥–æ–±–Ω–æ –¥–ª—è –ø–æ–∏—Å–∫–∞ –æ–±—â–µ–≥–æ –∫–æ–Ω—Ç–µ–Ω—Ç–∞.

### üìÖ –õ–µ–Ω—Ç–∞ —Å–æ–±—ã—Ç–∏–π
**–ê–≤—Ç–æ—Ä**: [StepanovAlAl](https://github.com/StepanovAlAl) | **SP**: 3  
–§–∏–∫—Å–∏—Ä—É–µ—Ç –≤—Å–µ –∑–Ω–∞—á–∏–º—ã–µ –¥–µ–π—Å—Ç–≤–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: –ª–∞–π–∫–∏, –æ—Ç–∑—ã–≤—ã, –¥—Ä—É–∂–±—É. –ü–æ–ª–Ω–∞—è –∏—Å—Ç–æ—Ä–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏.

## ER-–¥–∏–∞–≥—Ä–∞–º–º–∞ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö Filmorate

```mermaid
erDiagram
    users {
        int user_id
        string email
        string login
        string name
        date birthday
    }
    
    films {
        int film_id
        string name
        string description
        date release_date
        int duration
        int mpa_rating_id
    }
    
    genre {
        int genre_id
        string name
    }
    
    mpa_rating {
        int mpa_id
        string mpa_name
        string description
    }
    
    directors {
        int id
        string name
    }
    
    friendship {
        int user_id
        int friend_id
        string status
        timestamp created_date
    }
    
    film_genre {
        int film_id
        int genre_id
    }
    
    film_likes {
        int film_id
        int user_id
    }
    
    film_directors {
        int film_id
        int id
    }
    
    reviews {
        int review_id
        text content
        boolean is_positive
        int user_id
        int film_id
        int useful
    }
    
    review_likes {
        int review_id
        int user_id
        boolean is_like
    }
    
    feed {
        int event_id
        int user_id
        string event_type
        string operation
        int entity_id
        timestamp timestamp
    }

    users ||--o{ friendship : "–∏–º–µ–µ—Ç –¥—Ä—É–∑–µ–π"
    users ||--o{ film_likes : "—Å—Ç–∞–≤–∏—Ç –ª–∞–π–∫–∏"
    users ||--o{ reviews : "–ø–∏—à–µ—Ç –æ—Ç–∑—ã–≤—ã"
    users ||--o{ review_likes : "–æ—Ü–µ–Ω–∏–≤–∞–µ—Ç –æ—Ç–∑—ã–≤—ã"
    users ||--o{ feed : "–∏–º–µ–µ—Ç —Å–æ–±—ã—Ç–∏—è"
    films ||--o{ film_genre : "–∏–º–µ–µ—Ç –∂–∞–Ω—Ä—ã"
    films ||--o{ film_likes : "–ø–æ–ª—É—á–∞–µ—Ç –ª–∞–π–∫–∏"
    films ||--o{ film_directors : "–∏–º–µ–µ—Ç —Ä–µ–∂–∏—Å—Å–µ—Ä–æ–≤"
    films ||--o{ reviews : "–∏–º–µ–µ—Ç –æ—Ç–∑—ã–≤—ã"
    films }|--|| mpa_rating : "–∏–º–µ–µ—Ç —Ä–µ–π—Ç–∏–Ω–≥"
    film_genre }|--|| genre : "–æ—Ç–Ω–æ—Å–∏—Ç—Å—è –∫"
    film_directors }|--|| directors : "—Å–≤—è–∑–∞–Ω —Å"
    reviews }|--|| users : "–∞–≤—Ç–æ—Ä"
    reviews }|--|| films : "–æ —Ñ–∏–ª—å–º–µ"
    review_likes }|--|| reviews : "–¥–ª—è –æ—Ç–∑—ã–≤–∞"

